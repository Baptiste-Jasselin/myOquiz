# S05E03 - Modèles et Active Record

## Menu du jour

```
- Correction challenge
  - tous les modèles
  - et le CoreModel

- Architecture MVC
  - Data Access Layer
    - `DataMapper` (Design Pattern)
    - `Active Record` (Design Pattern)

- Page d'administration des Levels
```

## Recap POO et héritage

```js
// ======= HUMAIN =======
class Humain {
	name;
	birthdate;

	constructor(name, birthdate) {
		this.name = name;
		this.birthdate = birthdate;
	}

	eat() {
		console.log(`${this.name} est en train de manger...`);
	}
}

const quentin = new Humain("Quentin Logie", "1970-01-01"); // On instancie un humain
quentin.eat(); // Depuis l'exterieur de la classe, on utilise pas 'THIS' // Cette ligne affichera `Quentin Logie est en train de ma manger`
// Note : à l'EXTERIEUR de la classe, (this === window) ou (this === global)


// ======= SUPER HERO =======
class Superhero extends Humain { // Un Superhero hérite des attributs et des méthodes d'un "Humain"
	superpowers;

	constructor(name, birthdate, superpowers) {
		super(name, birthdate);

		this.superpowers = superpowers;
	}

	attack() {
		console.log("Bim bam boom");
	}
}

const superman = new Superhero("Clark Kent", "1950", ["flights", "lazer eyes"]);
superman.eat(); // Superman est aussi un humain, donc il peut 'eat'
superman.attack();

// OPERATEUR 'instanceof'
quentin instanceof Humain // true
quentin instanceof Superhero // false
superman instanceof Humain // true
superman instanceof Superhero // true
```

L'opérateur `instanceof` permet de savoir si une instance est un membre d'une classe particulière :
- `if (quentin instanceof Humain) {}` // Est-ce que quentin (instance) est un Humain (classe)



## Regex

`Regular Expression` = un "pattern" (format) pour du texte. 

On veut un email qui ressemble à ça  `xxxxxxx@yyyyyyy.zzz` : `\w+@\w+\.\w{2,3}`

Les REGEX sont des outils transverses présents dans tous les langages

Pour construire des regex : https://regex101.com/

Fiche Kourou : https://kourou.oclock.io/ressources/fiche-recap/regexp/


## EJS 

Extension EJS indispensable : `EJS language support`


## Data Access Layer - Couche d'accès aux données - DAL

**Composants d'accès aux données** : 
- `dataMapper`
- `models`

### Deux designs patterns classiques

- `dataMapper` : objet avec des méthodes pour l'appel à la BDD
- `Active Record` : un active record est une instance (de classe) avec des méthodes pour accéder à la BDD : 
  - un "record" (enregistrement) "active" (connecté à la BDD)

Cet aprem', on implémente dans nos modèles ce `Design Pattern`. 

Demain : on utilise une librairie (`Sequelize`) qui embarque déjà ce design pattern => plus besoin du code d'aujourd'hui. 

> An Active Record object that wraps a row in a database table or view, encapsulates the database access, and adds domain logic on that data.

https://www.martinfowler.com/eaaCatalog/activeRecord.html

> An Active Record is a model that stores an in-memory representation of a database row or document.

https://khalilstemmler.com/wiki/active-record/


